# Migration `20200306184821-init2`

This migration has been generated by Franklin Davenport at 3/6/2020, 6:48:21 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "quaint"."Alias" (
    "city" TEXT   ,
    "id" TEXT NOT NULL  ,
    "name" TEXT NOT NULL DEFAULT '' ,
    PRIMARY KEY ("id"),FOREIGN KEY ("city") REFERENCES "City"("id") ON DELETE SET NULL ON UPDATE CASCADE
) 

CREATE TABLE "quaint"."GeoDemographics" (
    "areaKmSq" REAL   ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "id" TEXT NOT NULL  ,
    "latitude" REAL   ,
    "longitude" REAL   ,
    "population" INTEGER   ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "quaint"."Country" (
    "abbreviation" TEXT NOT NULL DEFAULT '' ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "geoDemographics" TEXT   ,
    "id" TEXT NOT NULL  ,
    "name" TEXT NOT NULL DEFAULT '' ,
    PRIMARY KEY ("id"),FOREIGN KEY ("geoDemographics") REFERENCES "GeoDemographics"("id") ON DELETE SET NULL ON UPDATE CASCADE
) 

CREATE TABLE "quaint"."State" (
    "abbreviation" TEXT NOT NULL DEFAULT '' ,
    "country" TEXT   ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "geoDemographics" TEXT   ,
    "id" TEXT NOT NULL  ,
    "name" TEXT NOT NULL DEFAULT '' ,
    PRIMARY KEY ("id"),FOREIGN KEY ("geoDemographics") REFERENCES "GeoDemographics"("id") ON DELETE SET NULL ON UPDATE CASCADE,
FOREIGN KEY ("country") REFERENCES "Country"("id") ON DELETE SET NULL ON UPDATE CASCADE
) 

CREATE TABLE "quaint"."City" (
    "country" TEXT   ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "geoDemographics" TEXT   ,
    "id" TEXT NOT NULL  ,
    "name" TEXT NOT NULL DEFAULT '' ,
    "state" TEXT   ,
    PRIMARY KEY ("id"),FOREIGN KEY ("geoDemographics") REFERENCES "GeoDemographics"("id") ON DELETE SET NULL ON UPDATE CASCADE,
FOREIGN KEY ("country") REFERENCES "Country"("id") ON DELETE SET NULL ON UPDATE CASCADE,
FOREIGN KEY ("state") REFERENCES "State"("id") ON DELETE SET NULL ON UPDATE CASCADE
) 

CREATE TABLE "quaint"."Zip" (
    "code" TEXT NOT NULL DEFAULT '' ,
    "country" TEXT   ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "geoDemographics" TEXT   ,
    "id" TEXT NOT NULL  ,
    "state" TEXT   ,
    PRIMARY KEY ("id"),FOREIGN KEY ("geoDemographics") REFERENCES "GeoDemographics"("id") ON DELETE SET NULL ON UPDATE CASCADE,
FOREIGN KEY ("country") REFERENCES "Country"("id") ON DELETE SET NULL ON UPDATE CASCADE,
FOREIGN KEY ("state") REFERENCES "State"("id") ON DELETE SET NULL ON UPDATE CASCADE
) 

CREATE TABLE "quaint"."Address" (
    "city" TEXT   ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "id" TEXT NOT NULL  ,
    "state" TEXT   ,
    "street1" TEXT NOT NULL DEFAULT '' ,
    "street2" TEXT NOT NULL DEFAULT '' ,
    "street3" TEXT NOT NULL DEFAULT '' ,
    "zip" TEXT   ,
    PRIMARY KEY ("id"),FOREIGN KEY ("state") REFERENCES "State"("id") ON DELETE SET NULL ON UPDATE CASCADE,
FOREIGN KEY ("city") REFERENCES "City"("id") ON DELETE SET NULL ON UPDATE CASCADE,
FOREIGN KEY ("zip") REFERENCES "Zip"("id") ON DELETE SET NULL ON UPDATE CASCADE
) 

CREATE TABLE "quaint"."OrganizationAddress" (
    "address" TEXT NOT NULL  ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "id" TEXT NOT NULL  ,
    "organization" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("address") REFERENCES "Address"("id") ON DELETE RESTRICT ON UPDATE CASCADE,
FOREIGN KEY ("organization") REFERENCES "Organization"("id") ON DELETE RESTRICT ON UPDATE CASCADE
) 

CREATE TABLE "quaint"."Organization" (
    "id" TEXT NOT NULL  ,
    "name" TEXT NOT NULL DEFAULT '' ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "quaint"."PersonName" (
    "firstName" TEXT NOT NULL DEFAULT '' ,
    "id" TEXT NOT NULL  ,
    "lastName" TEXT NOT NULL DEFAULT '' ,
    "middleName" TEXT NOT NULL DEFAULT '' ,
    "suffix" TEXT NOT NULL DEFAULT '' ,
    "title" TEXT NOT NULL DEFAULT '' ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "quaint"."Person" (
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "dateOfBirth" DATE   ,
    "id" TEXT NOT NULL  ,
    "name" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("name") REFERENCES "PersonName"("id") ON DELETE RESTRICT ON UPDATE CASCADE
) 

CREATE TABLE "quaint"."PersonAddress" (
    "address" TEXT NOT NULL  ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "id" TEXT NOT NULL  ,
    "person" TEXT NOT NULL  ,
    "type" TEXT NOT NULL DEFAULT 'HOME' ,
    PRIMARY KEY ("id"),FOREIGN KEY ("address") REFERENCES "Address"("id") ON DELETE RESTRICT ON UPDATE CASCADE,
FOREIGN KEY ("person") REFERENCES "Person"("id") ON DELETE RESTRICT ON UPDATE CASCADE
) 

CREATE TABLE "quaint"."PersonEmail" (
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "email" TEXT NOT NULL DEFAULT '' ,
    "id" TEXT NOT NULL  ,
    "person" TEXT NOT NULL  ,
    "type" TEXT NOT NULL DEFAULT 'UNKNOWN' ,
    PRIMARY KEY ("id"),FOREIGN KEY ("person") REFERENCES "Person"("id") ON DELETE RESTRICT ON UPDATE CASCADE
) 

CREATE TABLE "quaint"."UserCredentials" (
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "expiresAt" DATE   ,
    "hash" TEXT NOT NULL DEFAULT '' ,
    "id" TEXT NOT NULL  ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "quaint"."User" (
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "credentials" TEXT   ,
    "id" TEXT NOT NULL  ,
    "person" TEXT NOT NULL  ,
    "primaryEmail" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("person") REFERENCES "Person"("id") ON DELETE RESTRICT ON UPDATE CASCADE,
FOREIGN KEY ("primaryEmail") REFERENCES "PersonEmail"("id") ON DELETE RESTRICT ON UPDATE CASCADE,
FOREIGN KEY ("credentials") REFERENCES "UserCredentials"("id") ON DELETE SET NULL ON UPDATE CASCADE
) 

CREATE UNIQUE INDEX "quaint"."Country.name" ON "Country"("name")

CREATE UNIQUE INDEX "quaint"."State.country_name" ON "State"("country","name")

CREATE UNIQUE INDEX "quaint"."City.state_name" ON "City"("state","name")

CREATE UNIQUE INDEX "quaint"."Zip.code" ON "Zip"("code")

CREATE UNIQUE INDEX "quaint"."PersonEmail.email" ON "PersonEmail"("email")

CREATE UNIQUE INDEX "quaint"."UserCredentials.user" ON "UserCredentials"("user")

CREATE UNIQUE INDEX "quaint"."User_credentials" ON "User"("credentials")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200306184821-init2
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,157 @@
+datasource sqlite {
+  provider = "sqlite"
+  url      = "file:data/dev-data.sqlite"
+}
+
+// datasource psql {
+//   provider = "postgres"
+//   url      = "postgresql://prisma:prisma4u@localhost:52209/db"
+// }
+
+generator client {
+  provider = "prisma-client-js"
+  output   = "./src/gen/client"
+}
+
+model Alias {
+  id   String @id @default(uuid())
+  name String
+}
+
+model GeoDemographics {
+  id         String   @id @default(uuid())
+  createdAt  DateTime @default(now())
+  population Int?
+  latitude   Float?
+  longitude  Float?
+  areaKmSq   Float?
+}
+
+model Country {
+  id           String   @id @default(uuid())
+  createdAt    DateTime @default(now())
+  name         String   @unique
+  abbreviation String
+
+  geoDemographics GeoDemographics?
+}
+
+model State {
+  id           String   @id @default(uuid())
+  createdAt    DateTime @default(now())
+  name         String
+  abbreviation String
+
+  country Country?
+
+  geoDemographics GeoDemographics?
+
+  @@unique([country, name])
+}
+
+model City {
+  id        String   @id @default(uuid())
+  createdAt DateTime @default(now())
+  name      String
+
+  aliases Alias[]
+  country Country?
+  state   State?
+
+  geoDemographics GeoDemographics?
+
+  @@unique([state, name])
+}
+
+model Zip {
+  id        String   @id @default(uuid())
+  createdAt DateTime @default(now())
+  code      String   @unique
+
+  country Country?
+  state   State?
+
+  geoDemographics GeoDemographics?
+}
+
+model Address {
+  id        String   @id @default(uuid())
+  createdAt DateTime @default(now())
+  street1   String   @default("")
+  street2   String   @default("")
+  street3   String   @default("")
+  city      City?
+  state     State?
+  zip       Zip?
+}
+
+model OrganizationAddress {
+  id           String       @id @default(uuid())
+  createdAt    DateTime     @default(now())
+  organization Organization
+  address      Address
+}
+
+model Organization {
+  id        String                @id @default(uuid())
+  name      String
+  addresses OrganizationAddress[]
+}
+
+model PersonName {
+  id         String @id @default(uuid())
+  firstName  String @default("")
+  middleName String @default("")
+  lastName   String @default("")
+  title      String @default("")
+  suffix     String @default("")
+}
+
+model Person {
+  id          String          @id @default(uuid())
+  createdAt   DateTime        @default(now())
+  name        PersonName
+  addresses   PersonAddress[]
+  emails      PersonEmail[]
+  dateOfBirth DateTime?
+}
+
+enum PersonAddressType {
+  HOME WORK OTHER UNKNOWN
+}
+
+model PersonAddress {
+  id        String            @id @default(uuid())
+  createdAt DateTime          @default(now())
+  type      PersonAddressType
+  person    Person
+  address   Address
+}
+
+enum PersonEmailType {
+  PERSONAL WORK OTHER UNKNOWN
+}
+
+model PersonEmail {
+  id        String          @id @default(uuid())
+  createdAt DateTime        @default(now())
+  type      PersonEmailType @default(UNKNOWN)
+  person    Person
+  email     String          @unique
+}
+
+model UserCredentials {
+  id        String    @id @default(uuid())
+  createdAt DateTime  @default(now())
+  expiresAt DateTime?
+  user      User      @unique
+  hash      String
+}
+
+model User {
+  id           String           @id @default(uuid())
+  createdAt    DateTime         @default(now())
+  person       Person
+  primaryEmail PersonEmail
+  credentials  UserCredentials?
+}
```


